@model List<MessManagementSystem.Models.Shared.AppSetting>

@{
    ViewData["Title"] = "Settings";
}

<div class="container-fluid mt-2 mt-md-0">
    <h2 class="h4 mb-1">System Settings</h2>
    <p class="text-muted mb-3">Configure meal rate and utility charges used in billing.</p>

    <form asp-action="Save" method="post" class="card shadow-sm">
        <div class="card-body">
            <div class="row">
                @for (var i = 0; i < Model.Count; i++)
                {
                    <div class="col-md-6 mb-3">
                        @{
                            // ✅ Convert raw keys to user-friendly labels
                            var label = Model[i].Key switch
                            {
                                "MealRate" => "Meal Rate (₹ per meal)",
                                "UtilityCharge" => "Utility Charge (₹ per month)",
                                _ => Model[i].Key // fallback for any future settings
                            };
                        }
                        <label class="form-label">@label</label>
                        <input type="hidden" name="[@i].Id" value="@Model[i].Id" />
                        <input type="text"
                               name="[@i].Value"
                               value="@Model[i].Value"
                               class="form-control"
                               placeholder="Enter numeric value"
                               required />
                        @if (Model[i].Key == "MealRate" || Model[i].Key == "UtilityCharge")
                        {
                            <div class="form-text">Only numbers allowed (e.g., 150)</div>
                        }
                    </div>
                }
            </div>
        </div>
        <div class="card-footer text-end">
            <button type="submit" class="btn btn-primary">
                <i class="fas fa-save me-1"></i>Save Settings
            </button>
        </div>
    </form>
</div>
@section Scripts {
    <script>
        document.querySelectorAll('input[name$=".Value"]').forEach(input => {
            input.addEventListener('keypress', function(e) {
                // Allow digits, decimal point, and control keys
                if (!/[0-9.]/.test(e.key) && !e.ctrlKey && !e.metaKey) {
                    e.preventDefault();
                }
            });
        });
    </script>
}