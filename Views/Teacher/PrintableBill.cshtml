@model MessManagementSystem.Models.Shared.BillDetailsViewModel

@{
    ViewData["Title"] = "Bill Statement";
    var ratePerMeal = Model.TotalMeals == 0 ? 0 : Model.MealTotal / Model.TotalMeals;
}

<style>
    .invoice-card {
        background: #fff;
        border-radius: 24px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.05);
        border: 1px solid #eee;
    }

    .invoice-header {
        background: var(--primary-gradient);
        color: white;
        border-radius: 24px 24px 0 0;
        padding: 2rem;
    }

    @@media print {
        @@page {
            size: auto;
            margin: 10mm;
        }

        body {
            background: white !important;
            color: black !important;
        }

        .no-print, .btn, .navbar, .sidebar {
            display: none !important;
        }

        .invoice-card {
            box-shadow: none !important;
            border: 1px solid #000 !important;
            border-radius: 0 !important;
        }

        .invoice-header {
            background: #eee !important;
            color: black !important;
            border-bottom: 2px solid #000 !important;
        }

        .text-primary {
            color: black !important;
        }
    }
</style>

<div class="container py-3">
    <div class="d-flex justify-content-between align-items-center mb-3 no-print">
        <a asp-action="MyBills" asp-controller="Teacher" class="text-decoration-none text-muted fw-bold">
            <i class="fas fa-arrow-left me-2"></i> History
        </a>
        <button class="btn text-white rounded-pill px-4 fw-bold shadow-sm" style="background: var(--primary-gradient); border:none;" onclick="window.print()">
            <i class="fas fa-print me-2"></i> Print Bill
        </button>
    </div>

    <div class="card invoice-card overflow-hidden">
        <div class="invoice-header">
            <div class="row align-items-center">
                <div class="col-7">
                    <h3 class="fw-800 mb-0">MESSLY STATEMENT</h3>
                    <p class="small opacity-75 mb-0">Faculty Dining Invoice</p>
                </div>
                <div class="col-5 text-end">
                    <span class="fw-800">@Model.BillingPeriodStart.ToString("MMMM yyyy")</span>
                </div>
            </div>
        </div>

        <div class="card-body p-4">
            <div class="row mb-4">
                <div class="col-6">
                    <small class="text-uppercase fw-800 opacity-50">Bill To:</small>
                    <h6 class="fw-bold mb-0">@Model.TeacherName</h6>
                    <p class="small text-muted">@Model.TeacherEmail | @Model.TeacherDepartment</p>
                </div>
                <div class="col-6 text-end">
                    <small class="text-uppercase fw-800 opacity-50">Details:</small>
                    <p class="small mb-0">Date: @DateTime.Now.ToString("dd/MM/yyyy")</p>
                    <p class="small mb-0">Invoice: #INV-@Model.BillId</p>
                </div>
            </div>

            <table class="table small">
                <thead class="table-light">
                    <tr>
                        <th>Description</th>
                        <th class="text-center">Rate</th>
                        <th class="text-end">Total</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Monthly Meals (@Model.TotalMeals)</td>
                        <td class="text-center">₹@ratePerMeal.ToString("F2")</td>
                        <td class="text-end fw-bold">₹@Model.MealTotal.ToString("F2")</td>
                    </tr>
                    <tr>
                        <td>Utility Charge</td>
                        <td class="text-center">Fixed</td>
                        <td class="text-end fw-bold">₹@Model.UtilityCharge.ToString("F2")</td>
                    </tr>
                    <tr>
                        <td class="text-danger fw-bold">Arrears</td>
                        <td class="text-center">-</td>
                        <td class="text-end fw-bold text-danger">₹@Model.PreviousDues.ToString("F2")</td>
                    </tr>
                </tbody>
            </table>

            <div class="row justify-content-end mt-4">
                <div class="col-5">
                    <div class="p-3 bg-light rounded-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <span class="fw-800">Total Payable:</span>
                            <span class="h5 fw-800 mb-0" style="color: var(--primary-purple);">₹@Model.TotalAmount.ToString("F2")</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>